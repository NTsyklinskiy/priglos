"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.UserInfo = exports.signIn = exports.init = exports.state = void 0;

var _regeneratorRuntime = require("regenerator-runtime");

var _config = require("./config.js");

var _helper = require("./helper.js");

const state = {
  user: {
    id: '',
    token: '',
    lastName: '',
    firstName: '',
    options: ''
  }
};
exports.state = state;

const init = function () {
  const storageUser = localStorage.getItem('user');

  if (storageUser) {
    state.user = JSON.parse(storageUser);
  }
};

exports.init = init;
init();

const signIn = async function (user) {
  try {
    const data = await (0, _helper.AJAX)(`${_config.API_URL}users/login`, user);
    logaa;
    state.user = {
      token: data.token,
      id: data.data.user._id,
      firstName: data.data.user.email,
      lastName: data.data.user.name,
      options: data.data.user.role
    };
    UserInfo();
  } catch (err) {
    throw err;
  }
};

exports.signIn = signIn;

const UserInfo = function () {
  localStorage.setItem('user', JSON.stringify(state.user));
};

exports.UserInfo = UserInfo;